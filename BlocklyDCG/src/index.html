<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <!-- Place favicon.ico in the root directory -->

        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">
        <script src="js/vendor/modernizr-2.8.3.min.js"></script>

        <!-- blockly scripts -->
        <script src="blockly/blockly_uncompressed.js"></script>

        <!-- generator script -->
        <script src="blockly/generators/dcg.js"></script>

        <!-- blockly language -->
        <script src="blockly/msg/js/nl.js"></script>
        <script src="blockly/blocks/eval.js"></script>

        <script src="blockly/blocks/logic.js"></script>
        <script src="blockly/blocks/loops.js"></script>
        <script src="blockly/blocks/math.js"></script>
        <script src="blockly/blocks/text.js"></script>
        <script src="blockly/blocks/lists.js"></script>
        <script src="blockly/blocks/variables.js"></script>
        <script src="blockly/blocks/procedures.js"></script>



        <!-- python examples -->
        <script src="blockly/generators/python/text.js"></script>


        <!-- dcg examples -->
        <script src="blockly/generators/dcg/text.js"></script>
        <script src="blockly/generators/dcg/variables.js"></script>

        <style>
            html, body {
                height: 100%;
                margin: 0;
            }
            body {
                background-color: #fff;
                font-family: sans-serif;
                overflow: hidden;
            }
            h1 {
                font-weight: normal;
                font-size: 140%;
            }
            table {
                height: 100%;
                width: 100%;
            }
            #blocklyArea {
                height: 99%;
            }
        </style>

    </head>
    <body>



        <!-- Add your site or application content here -->
        <!--<p>DCG editor</p>-->

        <table>
            <tr>
                <td>
                    <h1> DCG Editor met blockly PoC </h1>
                    <button onclick="generateCode()">generate</button>

                    <textarea id="ruletext" style="width: 500px; height: 100px">
                            test
                    </textarea>


            </tr>
            <tr>
                <td id="blocklyArea">
                </td>
            </tr>
        </table>

        <div id="blocklyDiv" style="position: absolute"></div>

        <xml id="toolbox" style="display: none">
            <!--<block type="controls_if"></block>-->
            <!--<block type="logic_compare"></block>-->
            <!--<block type="controls_repeat_ext"></block>-->
            <!-- <block type="math_number"></block> -->
            <!--<block type="math_arithmetic"></block>-->
            <block type="text"></block>
            <block type="text_append"></block>
            <block type="text_print"></block>
            <block type="variables_set"></block>
            <block type="variables_get"></block>
            <block type="eval"></block>
            <!--<block type="procedures_defnoreturn"></block>-->
        </xml>


        <script>
            var blocklyArea = document.getElementById('blocklyArea');
            var blocklyDiv = document.getElementById('blocklyDiv');
            var workspace = Blockly.inject(blocklyDiv,
                {media: 'blockly/media/',
                    toolbox: document.getElementById('toolbox')});
            var onresize = function(e) {
                // Compute the absolute coordinates and dimensions of blocklyArea.
                var element = blocklyArea;
                var x = 0;
                var y = 0;
                do {
                    x += element.offsetLeft;
                    y += element.offsetTop;
                    element = element.offsetParent;
                } while (element);
                // Position blocklyDiv over blocklyArea.
                blocklyDiv.style.left = x + 'px';
                blocklyDiv.style.top = y + 'px';
                blocklyDiv.style.width = blocklyArea.offsetWidth + 'px';
                blocklyDiv.style.height = blocklyArea.offsetHeight + 'px';
            };
            window.addEventListener('resize', onresize, false);
            onresize();
            Blockly.svgResize(workspace);

            function generateCode() {
                var code = Blockly.Dcg.workspaceToCode(workspace);
                document.getElementById('ruletext').innerHTML = code;
                console.log("set code: " + code)
            }
        </script>

    </body>
</html>
